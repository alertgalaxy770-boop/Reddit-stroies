<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Story Video Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

  <!-- Navbar -->
  <nav class="bg-white shadow p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-purple-600">StoryAI</h1>
    <button class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Login</button>
  </nav>

  <!-- Hero Section -->
  <section class="text-center py-16">
    <h2 class="text-4xl font-bold mb-4">Turn Reddit Stories into AI Videos</h2>
    <p class="text-gray-700 mb-6">Paste your story, choose a voice, and generate a faceless video in minutes.</p>
    <button class="bg-purple-600 text-white px-6 py-3 rounded hover:bg-purple-700">Create Free Video</button>
  </section>

  <!-- Create Project Section -->
  <section class="max-w-3xl mx-auto bg-white p-8 rounded shadow">
    <h3 class="text-2xl font-bold mb-4">Generate AI Narration</h3>
    <textarea id="storyInput" class="w-full border rounded p-2 mb-4" rows="6" placeholder="Paste your Reddit story here..."></textarea>

    <label class="block mb-2 font-semibold">Choose Voice:</label>
    <select id="voiceSelect" class="w-full border rounded p-2 mb-4">
      <option value="Joanna">Joanna (Female, English)</option>
      <option value="Matthew">Matthew (Male, English)</option>
    </select>

    <button id="generateBtn" class="bg-purple-600 text-white px-6 py-2 rounded hover:bg-purple-700">Generate Narration</button>

    <div id="audioContainer" class="mt-6 hidden">
      <h4 class="font-semibold mb-2">Preview Audio:</h4>
      <audio id="audioPlayer" controls class="w-full"></audio>
    </div>
  </section>

  <!-- Footer -->
  <footer class="text-center py-6 text-gray-600">
    &copy; 2026 StoryAI. All rights reserved.
  </footer>

  <!-- JS for TTS -->
  <script>
    const generateBtn = document.getElementById("generateBtn");
    const storyInput = document.getElementById("storyInput");
    const voiceSelect = document.getElementById("voiceSelect");
    const audioContainer = document.getElementById("audioContainer");
    const audioPlayer = document.getElementById("audioPlayer");

    generateBtn.addEventListener("click", async () => {
      const text = storyInput.value.trim();
      const voice = voiceSelect.value;

      if (!text) {
        alert("Please enter a story!");
        return;
      }

      // Simple browser TTS (Web Speech API) demo
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.voice = speechSynthesis.getVoices().find(v => v.name.includes(voice)) || speechSynthesis.getVoices()[0];
      speechSynthesis.speak(utterance);

      // Optional: Show placeholder audio player
      audioContainer.classList.remove("hidden");
      audioPlayer.src = "";
      audioPlayer.pause();
    });
  </script>
</body>
</html>


const generateBtn = document.getElementById("generateBtn");
const storyInput = document.getElementById("storyInput");
const voiceSelect = document.getElementById("voiceSelect");
const audioContainer = document.getElementById("audioContainer");
const audioPlayer = document.getElementById("audioPlayer");

// Function to populate voices once available
function populateVoices() {
  const voices = speechSynthesis.getVoices();
  voiceSelect.innerHTML = "";
  voices.forEach((v) => {
    // only add English voices
    if (v.lang.startsWith("en")) {
      const option = document.createElement("option");
      option.value = v.name;
      option.textContent = `${v.name} (${v.lang})`;
      voiceSelect.appendChild(option);
    }
  });
}

// Some browsers need this event to know when voices are ready
speechSynthesis.onvoiceschanged = populateVoices;

// Generate narration
generateBtn.addEventListener("click", () => {
  const text = storyInput.value.trim();
  const selectedVoice = voiceSelect.value;

  if (!text) {
    alert("Please enter a story!");
    return;
  }

  const utterance = new SpeechSynthesisUtterance(text);
  const voice = speechSynthesis.getVoices().find(v => v.name === selectedVoice);
  if (voice) utterance.voice = voice;

  speechSynthesis.speak(utterance);

  // Show audio container (placeholder)
  audioContainer.classList.remove("hidden");
});

audioPlayer.src = "";
audioPlayer.pause();
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Story Video Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

  <!-- Navbar -->
  <nav class="bg-white shadow p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-purple-600">StoryAI</h1>
    <button class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Login</button>
  </nav>

  <!-- Hero Section -->
  <section class="text-center py-16">
    <h2 class="text-4xl font-bold mb-4">Turn Reddit Stories into AI Videos</h2>
    <p class="text-gray-700 mb-6">Paste your story, choose a voice, and generate a faceless video in minutes.</p>
    <button class="bg-purple-600 text-white px-6 py-3 rounded hover:bg-purple-700">Create Free Video</button>
  </section>

  <!-- Create Project Section -->
  <section class="max-w-3xl mx-auto bg-white p-8 rounded shadow">
    <h3 class="text-2xl font-bold mb-4">Generate AI Narration</h3>
    <textarea id="storyInput" class="w-full border rounded p-2 mb-4" rows="6" placeholder="Paste your Reddit story here..."></textarea>

    <label class="block mb-2 font-semibold">Choose Voice:</label>
    <select id="voiceSelect" class="w-full border rounded p-2 mb-4">
      <!-- Voices will populate automatically -->
    </select>

    <button id="generateBtn" class="bg-purple-600 text-white px-6 py-2 rounded hover:bg-purple-700">Generate Narration</button>

    <div id="audioContainer" class="mt-6 hidden">
      <h4 class="font-semibold mb-2">Your narration is playing via browser TTS!</h4>
      <p class="text-gray-600 text-sm">Some browsers may require you to click the button to hear audio.</p>
    </div>
  </section>

  <!-- Footer -->
  <footer class="text-center py-6 text-gray-600">
    &copy; 2026 StoryAI. All rights reserved.
  </footer>

  <!-- JS for TTS -->
  <script>
    const generateBtn = document.getElementById("generateBtn");
    const storyInput = document.getElementById("storyInput");
    const voiceSelect = document.getElementById("voiceSelect");
    const audioContainer = document.getElementById("audioContainer");

    // Populate voices
    function populateVoices() {
      const voices = speechSynthesis.getVoices();
      voiceSelect.innerHTML = "";
      voices.forEach(v => {
        if(v.lang.startsWith("en")) {
          const option = document.createElement("option");
          option.value = v.name;
          option.textContent = `${v.name} (${v.lang})`;
          voiceSelect.appendChild(option);
        }
      });
    }

    // Some browsers fire this event when voices are ready
    speechSynthesis.onvoiceschanged = populateVoices;

    // Trigger narration
    generateBtn.addEventListener("click", () => {
      const text = storyInput.value.trim();
      const selectedVoice = voiceSelect.value;

      if(!text) {
        alert("Please enter a story!");
        return;
      }

      const utterance = new SpeechSynthesisUtterance(text);
      const voice = speechSynthesis.getVoices().find(v => v.name === selectedVoice);
      if(voice) utterance.voice = voice;

      speechSynthesis.speak(utterance);

      audioContainer.classList.remove("hidden");
    });

    // Initial population (some browsers require this)
    window.onload = () => {
      populateVoices();
    };
  </script>

</body>
</html>

const express = require("express");
const fetch = require("node-fetch");
const cors = require("cors");
const fs = require("fs");

const app = express();
app.use(express.json());
app.use(cors());

const ELEVEN_API_KEY = "YOUR_ELEVENLABS_API_KEY";

app.post("/generate", async (req, res) => {
  const { text, voice } = req.body;
  if (!text) return res.status(400).json({ error: "No text provided" });

  try {
    const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${voice}`, {
      method: "POST",
      headers: {
        "xi-api-key": ELEVEN_API_KEY,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        text: text,
        model_id: "eleven_monolingual_v1",
        voice_settings: { stability: 0.5, similarity_boost: 0.5 }
      })
    });

    const buffer = await response.arrayBuffer();
    const audioBase64 = Buffer.from(buffer).toString("base64");

    res.json({ audio: `data:audio/mpeg;base64,${audioBase64}` });
  } catch (err) {
    console.error(err);
    res.status(500).json({ error: "Failed to generate audio" });
  }
});

app.listen(3000, () => console.log("Server running on http://localhost:3000"));


generateBtn.addEventListener("click", async () => {
  const text = storyInput.value.trim();
  const selectedVoice = voiceSelect.value;

  if (!text) {
    alert("Please enter a story!");
    return;
  }

  audioContainer.classList.remove("hidden");
  audioContainer.innerHTML = "<p>Generating AI narration...</p>";

  try {
    const response = await fetch("http://localhost:3000/generate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text, voice: selectedVoice })
    });

    const data = await response.json();
    if (data.audio) {
      const audioPlayer = document.createElement("audio");
      audioPlayer.controls = true;
      audioPlayer.src = data.audio;
      audioContainer.innerHTML = "";
      audioContainer.appendChild(audioPlayer);
      audioPlayer.play();
    }
  } catch (err) {
    console.error(err);
    audioContainer.innerHTML = "<p>Failed to generate audio.</p>";
  }
});
